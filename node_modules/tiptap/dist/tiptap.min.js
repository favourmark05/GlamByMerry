
    /*!
    * tiptap v1.21.1
    * (c) 2019 Scrumpy UG (limited liability)
    * @license MIT
    */


!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("prosemirror-state"),require("prosemirror-view"),require("prosemirror-model"),require("prosemirror-dropcursor"),require("prosemirror-gapcursor"),require("prosemirror-keymap"),require("prosemirror-commands"),require("prosemirror-inputrules"),require("tiptap-utils"),require("vue"),require("tiptap-commands")):"function"==typeof define&&define.amd?define(["exports","prosemirror-state","prosemirror-view","prosemirror-model","prosemirror-dropcursor","prosemirror-gapcursor","prosemirror-keymap","prosemirror-commands","prosemirror-inputrules","tiptap-utils","vue","tiptap-commands"],e):e((t=t||self).tiptap={},t.prosemirrorState,t.prosemirrorView,t.prosemirrorModel,t.prosemirrorDropcursor,t.prosemirrorGapcursor,t.prosemirrorKeymap,t.prosemirrorCommands,t.prosemirrorInputrules,t.tiptapUtils,t.Vue,t.tiptapCommands)}(this,function(t,e,n,i,r,o,s,u,a,c,l,h){"use strict";function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function m(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),t}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){v(t,e,n[e])})}return t}function g(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function b(t,e){return(b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function w(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function x(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==u.return||u.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function O(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}l=l&&l.hasOwnProperty("default")?l.default:l;var P=function(){function t(e,n){var i=n.editor,r=n.extension,o=n.parent,s=n.node,u=n.view,a=n.decorations,c=n.getPos;f(this,t),this.component=e,this.editor=i,this.extension=r,this.parent=o,this.node=s,this.view=u,this.decorations=a,this.isNode=!!this.node.marks,this.isMark=!this.isNode,this.getPos=this.isMark?this.getMarkPos:c,this.dom=this.createDOM(),this.contentDOM=this.vm.$refs.content}return m(t,[{key:"createDOM",value:function(){var t=this,e=l.extend(this.component),n={editor:this.editor,node:this.node,view:this.view,getPos:function(){return t.getPos()},decorations:this.decorations,selected:!1,options:this.extension.options,updateAttrs:function(e){return t.updateAttrs(e)}};return this.vm=new e({parent:this.parent,propsData:n}).$mount(),this.vm.$el}},{key:"update",value:function(t,e){return t.type===this.node.type&&(t===this.node&&this.decorations===e||(this.node=t,this.decorations=e,this.updateComponentProps({node:t,decorations:e}),!0))}},{key:"updateComponentProps",value:function(t){var e=this;if(this.vm._props){var n=l.config.silent;l.config.silent=!0,Object.entries(t).forEach(function(t){var n=x(t,2),i=n[0],r=n[1];e.vm._props[i]=r}),l.config.silent=n}}},{key:"updateAttrs",value:function(t){if(this.view.editable){var e=this.view.state,n=this.node.type,i=this.getPos(),r=y({},this.node.attrs,t),o=this.isMark?e.tr.removeMark(i.from,i.to,n).addMark(i.from,i.to,n.create(r)):e.tr.setNodeMarkup(i,null,r);this.view.dispatch(o)}}},{key:"ignoreMutation",value:function(t){return!this.contentDOM||!this.contentDOM.contains(t.target)}},{key:"stopEvent",value:function(t){if("function"==typeof this.extension.stopEvent)return this.extension.stopEvent(t);var e="paste"===t.type;return!!!this.extension.schema.draggable&&!e}},{key:"selectNode",value:function(){this.updateComponentProps({selected:!0})}},{key:"deselectNode",value:function(){this.updateComponentProps({selected:!1})}},{key:"getMarkPos",value:function(){var t=this.view.posAtDOM(this.dom),e=this.view.state.doc.resolve(t);return c.getMarkRange(e,this.node.type)}},{key:"destroy",value:function(){this.vm.$destroy()}}]),t}(),A=function(){function t(){f(this,t)}return m(t,[{key:"on",value:function(t,e){return this._callbacks=this._callbacks||{},this._callbacks[t]||(this._callbacks[t]=[]),this._callbacks[t].push(e),this}},{key:"emit",value:function(t){for(var e=this,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this._callbacks=this._callbacks||{};var o=this._callbacks[t];return o&&o.forEach(function(t){return t.apply(e,i)}),this}},{key:"off",value:function(t,e){if(arguments.length){var n=this._callbacks?this._callbacks[t]:null;n&&(e?this._callbacks[t]=n.filter(function(t){return t!==e}):delete this._callbacks[t])}else this._callbacks={};return this}}]),t}(),M=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f(this,t),this.options=y({},this.defaultOptions,e)}return m(t,[{key:"init",value:function(){return null}},{key:"bindEditor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.editor=t}},{key:"inputRules",value:function(){return[]}},{key:"pasteRules",value:function(){return[]}},{key:"keys",value:function(){return{}}},{key:"name",get:function(){return null}},{key:"type",get:function(){return"extension"}},{key:"update",get:function(){return function(){}}},{key:"defaultOptions",get:function(){return{}}},{key:"plugins",get:function(){return[]}}]),t}(),S=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;f(this,t),e.forEach(function(t){t.bindEditor(n),t.init()}),this.extensions=e}return m(t,[{key:"keymaps",value:function(t){var e=t.schema,n=this.extensions.filter(function(t){return["extension"].includes(t.type)}).filter(function(t){return t.keys}).map(function(t){return t.keys({schema:e})}),i=this.extensions.filter(function(t){return["node","mark"].includes(t.type)}).filter(function(t){return t.keys}).map(function(t){return t.keys({type:e["".concat(t.type,"s")][t.name],schema:e})});return[].concat(O(n),O(i)).map(function(t){return s.keymap(t)})}},{key:"inputRules",value:function(t){var e=t.schema,n=t.excludedExtensions;if(!(n instanceof Array)&&n)return[];var i=n instanceof Array?this.extensions.filter(function(t){return!n.includes(t.name)}):this.extensions,r=i.filter(function(t){return["extension"].includes(t.type)}).filter(function(t){return t.inputRules}).map(function(t){return t.inputRules({schema:e})}),o=i.filter(function(t){return["node","mark"].includes(t.type)}).filter(function(t){return t.inputRules}).map(function(t){return t.inputRules({type:e["".concat(t.type,"s")][t.name],schema:e})});return[].concat(O(r),O(o)).reduce(function(t,e){return[].concat(O(t),O(e))},[])}},{key:"pasteRules",value:function(t){var e=t.schema,n=t.excludedExtensions;if(!(n instanceof Array)&&n)return[];var i=n instanceof Array?this.extensions.filter(function(t){return!n.includes(t.name)}):this.extensions,r=i.filter(function(t){return["extension"].includes(t.type)}).filter(function(t){return t.pasteRules}).map(function(t){return t.pasteRules({schema:e})}),o=i.filter(function(t){return["node","mark"].includes(t.type)}).filter(function(t){return t.pasteRules}).map(function(t){return t.pasteRules({type:e["".concat(t.type,"s")][t.name],schema:e})});return[].concat(O(r),O(o)).reduce(function(t,e){return[].concat(O(t),O(e))},[])}},{key:"commands",value:function(t){var e=t.schema,n=t.view;return this.extensions.filter(function(t){return t.commands}).reduce(function(t,i){var r=i.name,o=i.type,s={},u=i.commands(y({schema:e},["node","mark"].includes(o)?{type:e["".concat(o,"s")][r]}:{})),a=function(t,e){return!!n.editable&&(n.focus(),t(e)(n.state,n.dispatch,n))},c=function(t,e){Array.isArray(e)?s[t]=function(t){return e.forEach(function(e){return a(e,t)})}:"function"==typeof e&&(s[t]=function(t){return a(e,t)})};return"object"===d(u)?Object.entries(u).forEach(function(t){var e=x(t,2),n=e[0],i=e[1];c(n,i)}):c(r,u),y({},t,s)},{})}},{key:"nodes",get:function(){return this.extensions.filter(function(t){return"node"===t.type}).reduce(function(t,e){return y({},t,v({},e.name,e.schema))},{})}},{key:"options",get:function(){var t=this.view;return this.extensions.reduce(function(e,n){return y({},e,v({},n.name,new Proxy(n.options,{set:function(e,i,r){var o=e[i]!==r;return Object.assign(e,v({},i,r)),o&&n.update(t),!0}})))},{})}},{key:"marks",get:function(){return this.extensions.filter(function(t){return"mark"===t.type}).reduce(function(t,e){return y({},t,v({},e.name,e.schema))},{})}},{key:"plugins",get:function(){return this.extensions.filter(function(t){return t.plugins}).reduce(function(t,e){var n=e.plugins;return[].concat(O(t),O(n))},[])}}]),t}(),E=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f(this,e),w(this,k(e).call(this,t))}return g(e,M),m(e,[{key:"command",value:function(){return function(){}}},{key:"type",get:function(){return"mark"}},{key:"view",get:function(){return null}},{key:"schema",get:function(){return null}}]),e}(),R=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f(this,e),w(this,k(e).call(this,t))}return g(e,M),m(e,[{key:"command",value:function(){return function(){}}},{key:"type",get:function(){return"node"}},{key:"view",get:function(){return null}},{key:"schema",get:function(){return null}}]),e}(),j=function(t){function e(){return f(this,e),w(this,k(e).apply(this,arguments))}return g(e,R),m(e,[{key:"name",get:function(){return"doc"}},{key:"schema",get:function(){return{content:"block+"}}}]),e}(),N=function(t){function e(){return f(this,e),w(this,k(e).apply(this,arguments))}return g(e,R),m(e,[{key:"commands",value:function(t){var e=t.type;return function(){return h.setBlockType(e)}}},{key:"name",get:function(){return"paragraph"}},{key:"schema",get:function(){return{content:"inline*",group:"block",draggable:!1,parseDOM:[{tag:"p"}],toDOM:function(){return["p",0]}}}}]),e}(),C=function(t){function e(){return f(this,e),w(this,k(e).apply(this,arguments))}return g(e,R),m(e,[{key:"name",get:function(){return"text"}},{key:"schema",get:function(){return{group:"inline"}}}]),e}(),T=function(t){function l(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f(this,l),(t=w(this,k(l).call(this))).defaultOptions={editorProps:{},editable:!0,autoFocus:null,extensions:[],content:"",emptyDocument:{type:"doc",content:[{type:"paragraph"}]},useBuiltInExtensions:!0,disableInputRules:!1,disablePasteRules:!1,dropCursor:{},parseOptions:{},onInit:function(){},onTransaction:function(){},onUpdate:function(){},onFocus:function(){},onBlur:function(){},onPaste:function(){},onDrop:function(){}},t.events=["init","transaction","update","focus","blur","paste","drop"],t.init(e),t}return g(l,A),m(l,[{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setOptions(y({},this.defaultOptions,e)),this.element=document.createElement("div"),this.extensions=this.createExtensions(),this.nodes=this.createNodes(),this.marks=this.createMarks(),this.schema=this.createSchema(),this.plugins=this.createPlugins(),this.keymaps=this.createKeymaps(),this.inputRules=this.createInputRules(),this.pasteRules=this.createPasteRules(),this.view=this.createView(),this.commands=this.createCommands(),this.setActiveNodesAndMarks(),null!==this.options.autoFocus&&this.focus(this.options.autoFocus),this.events.forEach(function(e){var n;t.on(e,t.options[(n="on ".concat(e),n.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0===e?t.toLowerCase():t.toUpperCase()}).replace(/\s+/g,""))]||function(){})}),this.emit("init",{view:this.view,state:this.state}),this.extensions.view=this.view}},{key:"setOptions",value:function(t){this.options=y({},this.options,t),this.view&&this.state&&this.view.updateState(this.state)}},{key:"createExtensions",value:function(){return new S([].concat(O(this.builtInExtensions),O(this.options.extensions)),this)}},{key:"createPlugins",value:function(){return this.extensions.plugins}},{key:"createKeymaps",value:function(){return this.extensions.keymaps({schema:this.schema})}},{key:"createInputRules",value:function(){return this.extensions.inputRules({schema:this.schema,excludedExtensions:this.options.disableInputRules})}},{key:"createPasteRules",value:function(){return this.extensions.pasteRules({schema:this.schema,excludedExtensions:this.options.disablePasteRules})}},{key:"createCommands",value:function(){return this.extensions.commands({schema:this.schema,view:this.view})}},{key:"createNodes",value:function(){return this.extensions.nodes}},{key:"createMarks",value:function(){return this.extensions.marks}},{key:"createSchema",value:function(){return new i.Schema({nodes:this.nodes,marks:this.marks})}},{key:"createState",value:function(){var t=this;return e.EditorState.create({schema:this.schema,doc:this.createDocument(this.options.content),plugins:[].concat(O(this.plugins),[a.inputRules({rules:this.inputRules})],O(this.pasteRules),O(this.keymaps),[s.keymap({Backspace:a.undoInputRule}),s.keymap(u.baseKeymap),r.dropCursor(this.options.dropCursor),o.gapCursor(),new e.Plugin({key:new e.PluginKey("editable"),props:{editable:function(){return t.options.editable}}}),new e.Plugin({props:{attributes:{tabindex:0},handleDOMEvents:{focus:function(e){t.emit("focus",{event:e,state:t.state,view:t.view})},blur:function(e){t.emit("blur",{event:e,state:t.state,view:t.view})}}}}),new e.Plugin({props:this.options.editorProps})])})}},{key:"createDocument",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.parseOptions;if(null===t)return this.schema.nodeFromJSON(this.options.emptyDocument);if("object"===d(t))try{return this.schema.nodeFromJSON(t)}catch(e){return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",e),this.schema.nodeFromJSON(this.options.emptyDocument)}if("string"==typeof t){var n=document.createElement("div");return n.innerHTML=t.trim(),i.DOMParser.fromSchema(this.schema).parse(n,e)}return!1}},{key:"createView",value:function(){var t=this,e=new n.EditorView(this.element,{state:this.createState(),handlePaste:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.emit.apply(t,["paste"].concat(n))},handleDrop:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.emit.apply(t,["drop"].concat(n))},dispatchTransaction:this.dispatchTransaction.bind(this)});return e.dom.style.whiteSpace="pre-wrap",e}},{key:"setParentComponent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&this.view.setProps({nodeViews:this.initNodeViews({parent:t,extensions:[].concat(O(this.builtInExtensions),O(this.options.extensions))})})}},{key:"initNodeViews",value:function(t){var e=this,n=t.parent;return t.extensions.filter(function(t){return["node","mark"].includes(t.type)}).filter(function(t){return t.view}).reduce(function(t,i){return y({},t,v({},i.name,function(t,r,o,s){var u=i.view;return new P(u,{editor:e,extension:i,parent:n,node:t,view:r,getPos:o,decorations:s})}))},{})}},{key:"dispatchTransaction",value:function(t){var e=this.state.apply(t);this.view.updateState(e),this.setActiveNodesAndMarks(),this.emit("transaction",{getHTML:this.getHTML.bind(this),getJSON:this.getJSON.bind(this),state:this.state,transaction:t}),t.docChanged&&this.emitUpdate(t)}},{key:"emitUpdate",value:function(t){this.emit("update",{getHTML:this.getHTML.bind(this),getJSON:this.getJSON.bind(this),state:this.state,transaction:t})}},{key:"focus",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null!==n&&!1!==n){var i=n;"start"===n||!0===n?i=0:"end"===n&&(i=this.view.state.doc.nodeSize-2);var r=e.TextSelection.near(this.view.state.doc.resolve(i)),o=this.view.state.tr.setSelection(r);this.view.dispatch(o),setTimeout(function(){t.view.focus()},10)}}},{key:"blur",value:function(){this.view.dom.blur()}},{key:"getSchemaJSON",value:function(){return JSON.parse(JSON.stringify({nodes:this.extensions.nodes,marks:this.extensions.marks}))}},{key:"getHTML",value:function(){var t=document.createElement("div"),e=i.DOMSerializer.fromSchema(this.schema).serializeFragment(this.state.doc.content);return t.appendChild(e),t.innerHTML}},{key:"getJSON",value:function(){return this.state.doc.toJSON()}},{key:"setContent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,r=e.EditorState.create({schema:this.state.schema,doc:this.createDocument(t,i),plugins:this.state.plugins});this.view.updateState(r),n&&this.emitUpdate()}},{key:"clearContent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.setContent(this.options.emptyDocument,t)}},{key:"setActiveNodesAndMarks",value:function(){var t=this;this.activeMarks=Object.entries(this.schema.marks).reduce(function(e,n){var i=x(n,2),r=i[0],o=i[1];return y({},e,v({},r,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c.markIsActive(t.state,o,e)}))},{}),this.activeMarkAttrs=Object.entries(this.schema.marks).reduce(function(e,n){var i=x(n,2),r=i[0],o=i[1];return y({},e,v({},r,c.getMarkAttrs(t.state,o)))},{}),this.activeNodes=Object.entries(this.schema.nodes).reduce(function(e,n){var i=x(n,2),r=i[0],o=i[1];return y({},e,v({},r,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c.nodeIsActive(t.state,o,e)}))},{})}},{key:"getMarkAttrs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.activeMarkAttrs[t]}},{key:"registerPlugin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t){var e=this.state.reconfigure({plugins:this.state.plugins.concat([t])});this.view.updateState(e)}}},{key:"unregisterPlugin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t&&this.view.docView){var e=this.state.reconfigure({plugins:this.state.plugins.filter(function(e){return!e.key.startsWith("".concat(t,"$"))})});this.view.updateState(e)}}},{key:"destroy",value:function(){this.view&&this.view.destroy()}},{key:"builtInExtensions",get:function(){return this.options.useBuiltInExtensions?[new j,new C,new N]:[]}},{key:"state",get:function(){return this.view?this.view.state:null}},{key:"isActive",get:function(){return Object.entries(y({},this.activeMarks,this.activeNodes)).reduce(function(t,e){var n=x(e,2),i=n[0],r=n[1];return y({},t,v({},i,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(t)}))},{})}}]),l}(),_={props:{editor:{default:null,type:Object}},watch:{editor:{immediate:!0,handler:function(t){var e=this;t&&t.element&&this.$nextTick(function(){e.$el.appendChild(t.element.firstChild),t.setParentComponent(e)})}}},render:function(t){return t("div")},beforeDestroy:function(){this.editor.element=this.$el}},D={props:{editor:{default:null,type:Object}},render:function(){return this.editor?this.$scopedSlots.default({focused:this.editor.view.focused,focus:this.editor.focus,commands:this.editor.commands,isActive:this.editor.isActive,getMarkAttrs:this.editor.getMarkAttrs.bind(this.editor)}):null}};function V(t,e,n){var i=document.createRange();return i.setEnd(t,null==n?t.nodeValue.length:n),i.setStart(t,e||0),i}function I(t,e){var n=t.getClientRects();return n.length?n[e<0?0:n.length-1]:t.getBoundingClientRect()}function $(t,e){var n,i,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t.docView.domFromPos(e),s=o.node,u=o.offset;if(3===s.nodeType)r&&u<s.nodeValue.length?(i=I(V(s,u-1,u),-1),n="right"):u<s.nodeValue.length&&(i=I(V(s,u,u+1),-1),n="left");else if(s.firstChild){if(u<s.childNodes.length){var a=s.childNodes[u];i=I(3===a.nodeType?V(a):a,-1),n="left"}if((!i||i.top===i.bottom)&&u){var c=s.childNodes[u-1];i=I(3===c.nodeType?V(c):c,1),n="right"}}else i=s.getBoundingClientRect(),n="left";var l=i[n];return{top:i.top,bottom:i.bottom,left:l,right:l}}var B=function(){function t(e){var n=e.options,i=e.editorView;f(this,t),this.options=y({},{element:null,keepInBounds:!0,onUpdate:function(){return!1}},n),this.editorView=i,this.isActive=!1,this.left=0,this.bottom=0,this.editorView.dom.addEventListener("blur",this.hide.bind(this))}return m(t,[{key:"update",value:function(t,e){var n=t.state;if(!(e&&e.doc.eq(n.doc)&&e.selection.eq(n.selection)))if(n.selection.empty)this.hide();else{var i=n.selection,r=i.from,o=i.to,s=$(t,r),u=$(t,o,!0),a=this.options.element.offsetParent.getBoundingClientRect(),c=this.options.element.getBoundingClientRect(),l=(s.left+u.left)/2-a.left;this.left=Math.round(this.options.keepInBounds?Math.min(a.width-c.width/2,Math.max(l,c.width/2)):l),this.bottom=Math.round(a.bottom-s.top),this.isActive=!0,this.sendUpdate()}}},{key:"sendUpdate",value:function(){this.options.onUpdate({isActive:this.isActive,left:this.left,bottom:this.bottom})}},{key:"hide",value:function(t){t&&t.relatedTarget||(this.isActive=!1,this.sendUpdate())}},{key:"destroy",value:function(){this.editorView.dom.removeEventListener("blur",this.hide)}}]),t}();var U={props:{editor:{default:null,type:Object},keepInBounds:{default:!0,type:Boolean}},data:function(){return{menu:{isActive:!1,left:0,bottom:0}}},watch:{editor:{immediate:!0,handler:function(t){var n=this;t&&this.$nextTick(function(){var i;t.registerPlugin((i={element:n.$el,keepInBounds:n.keepInBounds,onUpdate:function(t){t.isActive&&!1===n.menu.isActive?n.$emit("show",t):t.isActive||!0!==n.menu.isActive||n.$emit("hide",t),n.menu=t}},new e.Plugin({key:new e.PluginKey("menu_bubble"),view:function(t){return new B({editorView:t,options:i})}})))})}}},render:function(){return this.editor?this.$scopedSlots.default({focused:this.editor.view.focused,focus:this.editor.focus,commands:this.editor.commands,isActive:this.editor.isActive,getMarkAttrs:this.editor.getMarkAttrs.bind(this.editor),menu:this.menu}):null},beforeDestroy:function(){this.editor.unregisterPlugin("menu_bubble")}},q=function(){function t(e){var n=e.options,i=e.editorView;f(this,t),this.options=y({},{element:null,onUpdate:function(){return!1}},n),this.editorView=i,this.isActive=!1,this.top=0,this.editorView.dom.addEventListener("blur",this.hide.bind(this))}return m(t,[{key:"update",value:function(t,e){var n=t.state;if(!(e&&e.doc.eq(n.doc)&&e.selection.eq(n.selection)))if(n.selection.empty){var i=t.domAtPos(n.selection.$anchor.pos);if("<br>"===i.node.innerHTML&&"P"===i.node.tagName&&i.node.parentNode===t.dom){var r=this.options.element.offsetParent.getBoundingClientRect(),o=t.coordsAtPos(n.selection.$anchor.pos).top-r.top;this.isActive=!0,this.top=o,this.sendUpdate()}else this.hide()}else this.hide()}},{key:"sendUpdate",value:function(){this.options.onUpdate({isActive:this.isActive,top:this.top})}},{key:"hide",value:function(t){t&&t.relatedTarget||(this.isActive=!1,this.sendUpdate())}},{key:"destroy",value:function(){this.editorView.dom.removeEventListener("blur",this.hide)}}]),t}();var L={props:{editor:{default:null,type:Object}},data:function(){return{menu:{isActive:!1,left:0,bottom:0}}},watch:{editor:{immediate:!0,handler:function(t){var n=this;t&&this.$nextTick(function(){var i;t.registerPlugin((i={element:n.$el,onUpdate:function(t){n.menu=t}},new e.Plugin({key:new e.PluginKey("floating_menu"),view:function(t){return new q({editorView:t,options:i})}})))})}}},render:function(){return this.editor?this.$scopedSlots.default({focused:this.editor.view.focused,focus:this.editor.focus,commands:this.editor.commands,isActive:this.editor.isActive,getMarkAttrs:this.editor.getMarkAttrs.bind(this.editor),menu:this.menu}):null},beforeDestroy:function(){this.editor.unregisterPlugin("floating_menu")}};Object.defineProperty(t,"NodeSelection",{enumerable:!0,get:function(){return e.NodeSelection}}),Object.defineProperty(t,"Plugin",{enumerable:!0,get:function(){return e.Plugin}}),Object.defineProperty(t,"PluginKey",{enumerable:!0,get:function(){return e.PluginKey}}),Object.defineProperty(t,"TextSelection",{enumerable:!0,get:function(){return e.TextSelection}}),t.Doc=j,t.Editor=T,t.EditorContent=_,t.EditorFloatingMenu=L,t.EditorMenuBar=D,t.EditorMenuBubble=U,t.Extension=M,t.Mark=E,t.Node=R,t.Paragraph=N,t.Text=C,Object.defineProperty(t,"__esModule",{value:!0})});